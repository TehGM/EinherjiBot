@page "/"
@using TehGM.EinherjiBot.UI.Security
@inject IDiscordLoginRedirect LoginRedirect

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

<AuthorizeView>
    <NotAuthorized>
        <a @onclick="this.RedirectToLoginAsync">Login with Discord</a>
    </NotAuthorized>
    <Authorizing>
        Logging in...
    </Authorizing>
    <Authorized>
        Hello @this.AuthProvider.User.ToString()<br/>
        <a @onclick="this.LogoutAsync">Logout</a>
    </Authorized>
</AuthorizeView>

@code {
    private Task RedirectToLoginAsync()
        => this.LoginRedirect.RedirectAsync();
    private Task LogoutAsync()
        => (this.AuthProvider as IWebAuthProvider).LogoutAsync();
}